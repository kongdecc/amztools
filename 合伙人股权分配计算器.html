<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆä¼™äººè‚¡æƒåˆ†é…è®¡ç®—å™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        .author-info {
            text-align: center;
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 30px;
            font-style: italic;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .section h3 {
            color: #34495e;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        input[type="number"]:focus, input[type="text"]:focus {
            border-color: #3498db;
            outline: none;
        }
        .result {
            background-color: #e8f5e8;
            font-weight: bold;
        }
        .partner-a {
            background-color: #e3f2fd;
        }
        .partner-b {
            background-color: #fff3e0;
        }
        .download-btn {
            background-color: #27ae60;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        .download-btn:hover {
            background-color: #219a52;
        }
        .ratio-input {
            background-color: #fff3cd;
            font-weight: bold;
        }
        .warning {
            color: #d32f2f;
            font-size: 12px;
            margin-top: 5px;
        }
        .error-warning {
            color: #d32f2f;
            font-size: 14px;
            margin-top: 10px;
            padding: 10px;
            background-color: #ffebee;
            border: 1px solid #f8bbd9;
            border-radius: 4px;
            font-weight: bold;
        }
        .investment-error {
            border-color: #d32f2f !important;
            background-color: #ffebee !important;
        }
        .readonly-input {
            background-color: #f0f0f0 !important;
            color: #666;
            cursor: not-allowed;
        }
        .input-warning {
            color: #f39c12;
            font-size: 12px;
            margin-top: 5px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š åˆä¼™äººè‚¡æƒåˆ†é…è®¡ç®—å™¨</h1>
        <div class="author-info">ä½œè€…å…¬ä¼—å·ï¼šå¿…èƒœå“¥çš„ä¸‰æ¿æ–§</div>
        
        <div class="section">
            <h3>ğŸ’° åŸºç¡€æŠ•èµ„ä¿¡æ¯</h3>
            <table>
                <tr>
                    <th>é¡¹ç›®</th>
                    <th>é‡‘é¢/æ¯”ä¾‹</th>
                    <th>è¯´æ˜</th>
                </tr>
                <tr>
                    <td>æ€»æŠ•èµ„é‡‘é¢</td>
                    <td><input type="number" id="totalInvestment" value="200000" oninput="calculate()"> å…ƒ</td>
                    <td>é¡¹ç›®å¯åŠ¨æ‰€éœ€çš„æ€»èµ„é‡‘</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h3>âš–ï¸ è‚¡æƒç»“æ„åˆ†é…</h3>
            <table>
                <tr>
                    <th>è‚¡æƒç±»å‹</th>
                    <th>å æ€»è‚¡æƒæ¯”ä¾‹</th>
                    <th>è¯´æ˜</th>
                </tr>
                <tr class="ratio-input">
                    <td>èµ„é‡‘è‚¡</td>
                    <td><input type="number" id="fundRatio" value="50" min="0" max="100" oninput="updateLaborRatio(); calculate()">%</td>
                    <td>æŒ‰å‡ºèµ„æ¯”ä¾‹åˆ†é…çš„è‚¡æƒ</td>
                </tr>
                <tr class="ratio-input">
                    <td>äººåŠ›è‚¡</td>
                    <td><span id="laborRatio">50</span>%</td>
                    <td>æŒ‰å·¥ä½œæŠ•å…¥åˆ†é…çš„è‚¡æƒ</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h3>ğŸ’¸ èµ„é‡‘è‚¡åˆ†é… (å æ€»è‚¡æƒ<span id="fundRatioDisplay">50</span>%)</h3>
            <table>
                <tr>
                    <th>åˆä¼™äºº</th>
                    <th>å‡ºèµ„é‡‘é¢ (å…ƒ)</th>
                    <th>èµ„é‡‘è‚¡å æ¯”</th>
                    <th>å¯¹åº”æ€»è‚¡æƒæ¯”ä¾‹</th>
                </tr>
                <tr class="partner-a">
                    <td>åˆä¼™äºº A</td>
                    <td>
                        <input type="number" id="investmentA" value="100000" oninput="calculate()">
                        <div class="input-warning" id="investmentAWarning" style="display:none;">
                            âš ï¸ å‡ºèµ„é‡‘é¢ä¸èƒ½è¶…è¿‡æ€»æŠ•èµ„é‡‘é¢
                        </div>
                    </td>
                    <td><span id="fundShareA">50.0%</span></td>
                    <td><span id="fundEquityA">25.0%</span></td>
                </tr>
                <tr class="partner-b">
                    <td>åˆä¼™äºº B</td>
                    <td>
                        <input type="number" id="investmentB" value="100000" class="readonly-input" readonly>
                        <div class="input-warning">
                            ğŸ’¡ è‡ªåŠ¨è®¡ç®— = æ€»æŠ•èµ„ - åˆä¼™äººAå‡ºèµ„
                        </div>
                    </td>
                    <td><span id="fundShareB">50.0%</span></td>
                    <td><span id="fundEquityB">25.0%</span></td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h3>ğŸ‘¥ äººåŠ›è‚¡åˆ†é… (å æ€»è‚¡æƒ<span id="laborRatioDisplay">50</span>%)</h3>
            <table>
                <tr>
                    <th>åˆä¼™äºº</th>
                    <th>äººåŠ›è‚¡å æ¯”</th>
                    <th>å¯¹åº”æ€»è‚¡æƒæ¯”ä¾‹</th>
                    <th>ä¸»è¦èŒè´£</th>
                </tr>
                <tr class="partner-a">
                    <td>åˆä¼™äºº A</td>
                    <td>
                        <input type="number" id="laborShareA" value="80" min="0" max="100" oninput="calculate()">%
                        <div class="input-warning" id="laborShareAWarning" style="display:none;">
                            âš ï¸ äººåŠ›è‚¡å æ¯”ä¸èƒ½è¶…è¿‡100%
                        </div>
                    </td>
                    <td><span id="laborEquityA">40.0%</span></td>
                    <td><input type="text" id="roleA" value="ä¾›åº”é“¾ã€è¿è¥ã€å¹¿å‘Šç­‰æ ¸å¿ƒå·¥ä½œ" style="width:200px;"></td>
                </tr>
                <tr class="partner-b">
                    <td>åˆä¼™äºº B</td>
                    <td>
                        <input type="number" id="laborShareB" value="20" class="readonly-input" readonly>%
                        <div class="input-warning">
                            ğŸ’¡ è‡ªåŠ¨è®¡ç®— = 100% - åˆä¼™äººAäººåŠ›è‚¡å æ¯”
                        </div>
                    </td>
                    <td><span id="laborEquityB">10.0%</span></td>
                    <td><input type="text" id="roleB" value="å®¢æœã€å‘è´§ç­‰ååŠ©å·¥ä½œ" style="width:200px;"></td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h3>ğŸ“ˆ æœ€ç»ˆè‚¡æƒåˆ†é…ç»“æœ</h3>
            <table>
                <tr>
                    <th>åˆä¼™äºº</th>
                    <th>èµ„é‡‘è‚¡æƒ</th>
                    <th>äººåŠ›è‚¡æƒ</th>
                    <th>æ€»è‚¡æƒæ¯”ä¾‹</th>
                    <th>è‚¡æƒä»·å€¼ (å…ƒ)</th>
                </tr>
                <tr class="partner-a result">
                    <td>åˆä¼™äºº A</td>
                    <td><span id="finalFundA">25.0%</span></td>
                    <td><span id="finalLaborA">40.0%</span></td>
                    <td><span id="finalTotalA">65.0%</span></td>
                    <td><span id="finalValueA">130,000</span></td>
                </tr>
                <tr class="partner-b result">
                    <td>åˆä¼™äºº B</td>
                    <td><span id="finalFundB">25.0%</span></td>
                    <td><span id="finalLaborB">10.0%</span></td>
                    <td><span id="finalTotalB">35.0%</span></td>
                    <td><span id="finalValueB">70,000</span></td>
                </tr>
            </table>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <button class="download-btn" onclick="downloadExcel()">ğŸ“¥ ä¸‹è½½ Excel è¡¨æ ¼</button>
            <button class="download-btn" onclick="window.print()" style="background-color: #3498db;">ğŸ–¨ï¸ æ‰“å°æŠ¥å‘Š</button>
        </div>
    </div>

    <script>
        function updateLaborRatio() {
            const fundRatio = parseFloat(document.getElementById('fundRatio').value) || 0;
            const laborRatio = Math.max(0, 100 - fundRatio);
            document.getElementById('laborRatio').textContent = laborRatio;
            document.getElementById('fundRatioDisplay').textContent = fundRatio;
            document.getElementById('laborRatioDisplay').textContent = laborRatio;
        }
        
        function calculate() {
            const totalInv = parseFloat(document.getElementById('totalInvestment').value) || 0;
            const invA = parseFloat(document.getElementById('investmentA').value) || 0;
            const laborA = parseFloat(document.getElementById('laborShareA').value) || 0;
            const fundRatio = parseFloat(document.getElementById('fundRatio').value) || 0;
            const laborRatio = 100 - fundRatio;
            
            // æ›´æ–°æ˜¾ç¤ºçš„æ¯”ä¾‹
            updateLaborRatio();
            
            // æ£€æŸ¥åˆä¼™äººAå‡ºèµ„æ˜¯å¦è¶…è¿‡æ€»æŠ•èµ„
            const investmentAWarning = document.getElementById('investmentAWarning');
            const investmentAInput = document.getElementById('investmentA');
            
            if (invA > totalInv) {
                investmentAWarning.style.display = 'block';
                investmentAInput.classList.add('investment-error');
            } else {
                investmentAWarning.style.display = 'none';
                investmentAInput.classList.remove('investment-error');
            }
            
            // æ£€æŸ¥åˆä¼™äººAäººåŠ›è‚¡æ˜¯å¦è¶…è¿‡100%
            const laborShareAWarning = document.getElementById('laborShareAWarning');
            const laborShareAInput = document.getElementById('laborShareA');
            
            if (laborA > 100) {
                laborShareAWarning.style.display = 'block';
                laborShareAInput.classList.add('investment-error');
            } else {
                laborShareAWarning.style.display = 'none';
                laborShareAInput.classList.remove('investment-error');
            }
            
            // è‡ªåŠ¨è®¡ç®—åˆä¼™äººBçš„å‡ºèµ„é‡‘é¢
            const invB = Math.max(0, totalInv - invA);
            document.getElementById('investmentB').value = invB;
            
            // è‡ªåŠ¨è®¡ç®—åˆä¼™äººBçš„äººåŠ›è‚¡å æ¯”
            const laborB = Math.max(0, 100 - laborA);
            document.getElementById('laborShareB').value = laborB;
            
            // è®¡ç®—èµ„é‡‘è‚¡æ¯”ä¾‹
            const totalFund = invA + invB;
            const fundShareA = totalFund > 0 ? (invA / totalFund * 100) : 0;
            const fundShareB = totalFund > 0 ? (invB / totalFund * 100) : 0;
            
            // èµ„é‡‘è‚¡å¯¹åº”çš„æ€»è‚¡æƒæ¯”ä¾‹
            const fundEquityA = (fundShareA / 100) * fundRatio;
            const fundEquityB = (fundShareB / 100) * fundRatio;
            
            // äººåŠ›è‚¡å¯¹åº”çš„æ€»è‚¡æƒæ¯”ä¾‹
            const laborEquityA = (laborA / 100) * laborRatio;
            const laborEquityB = (laborB / 100) * laborRatio;
            
            // æœ€ç»ˆæ€»è‚¡æƒ
            const totalEquityA = fundEquityA + laborEquityA;
            const totalEquityB = fundEquityB + laborEquityB;
            
            // è‚¡æƒä»·å€¼
            const valueA = totalInv * (totalEquityA / 100);
            const valueB = totalInv * (totalEquityB / 100);
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('fundShareA').textContent = fundShareA.toFixed(1) + '%';
            document.getElementById('fundShareB').textContent = fundShareB.toFixed(1) + '%';
            document.getElementById('fundEquityA').textContent = fundEquityA.toFixed(1) + '%';
            document.getElementById('fundEquityB').textContent = fundEquityB.toFixed(1) + '%';
            document.getElementById('laborEquityA').textContent = laborEquityA.toFixed(1) + '%';
            document.getElementById('laborEquityB').textContent = laborEquityB.toFixed(1) + '%';
            
            document.getElementById('finalFundA').textContent = fundEquityA.toFixed(1) + '%';
            document.getElementById('finalFundB').textContent = fundEquityB.toFixed(1) + '%';
            document.getElementById('finalLaborA').textContent = laborEquityA.toFixed(1) + '%';
            document.getElementById('finalLaborB').textContent = laborEquityB.toFixed(1) + '%';
            document.getElementById('finalTotalA').textContent = totalEquityA.toFixed(1) + '%';
            document.getElementById('finalTotalB').textContent = totalEquityB.toFixed(1) + '%';
            document.getElementById('finalValueA').textContent = valueA.toLocaleString('zh-CN');
            document.getElementById('finalValueB').textContent = valueB.toLocaleString('zh-CN');
        }
        
        function downloadExcel() {
            const totalInv = parseFloat(document.getElementById('totalInvestment').value) || 0;
            const invA = parseFloat(document.getElementById('investmentA').value) || 0;
            const laborA = parseFloat(document.getElementById('laborShareA').value) || 0;
            
            // æ£€æŸ¥åˆä¼™äººAå‡ºèµ„æ˜¯å¦è¶…è¿‡æ€»æŠ•èµ„
            if (invA > totalInv) {
                alert('é”™è¯¯ï¼šåˆä¼™äººAå‡ºèµ„é‡‘é¢ä¸èƒ½è¶…è¿‡æ€»æŠ•èµ„é‡‘é¢ï¼Œè¯·å…ˆä¿®æ­£åå†ä¸‹è½½ï¼');
                return;
            }
            
            // æ£€æŸ¥åˆä¼™äººAäººåŠ›è‚¡æ˜¯å¦è¶…è¿‡100%
            if (laborA > 100) {
                alert('é”™è¯¯ï¼šåˆä¼™äººAäººåŠ›è‚¡å æ¯”ä¸èƒ½è¶…è¿‡100%ï¼Œè¯·å…ˆä¿®æ­£åå†ä¸‹è½½ï¼');
                return;
            }
            
            const invB = totalInv - invA;
            const laborB = 100 - laborA;
            const fundRatio = parseFloat(document.getElementById('fundRatio').value) || 0;
            const laborRatio = 100 - fundRatio;
            const roleA = document.getElementById('roleA').value;
            const roleB = document.getElementById('roleB').value;
            
            // è®¡ç®—æ•°æ®
            const totalFund = invA + invB;
            const fundShareA = totalFund > 0 ? (invA / totalFund * 100) : 0;
            const fundShareB = totalFund > 0 ? (invB / totalFund * 100) : 0;
            const fundEquityA = (fundShareA / 100) * fundRatio;
            const fundEquityB = (fundShareB / 100) * fundRatio;
            const laborEquityA = (laborA / 100) * laborRatio;
            const laborEquityB = (laborB / 100) * laborRatio;
            const totalEquityA = fundEquityA + laborEquityA;
            const totalEquityB = fundEquityB + laborEquityB;
            const valueA = totalInv * (totalEquityA / 100);
            const valueB = totalInv * (totalEquityB / 100);
            
            // åˆ›å»ºExcelæ•°æ®
            const data = [
                ['åˆä¼™äººè‚¡æƒåˆ†é…è®¡ç®—è¡¨'],
                ['ä½œè€…å…¬ä¼—å·ï¼šå¿…èƒœå“¥çš„ä¸‰æ¿æ–§'],
                [''],
                ['åŸºç¡€ä¿¡æ¯'],
                ['æ€»æŠ•èµ„é‡‘é¢', totalInv, 'å…ƒ'],
                [''],
                ['è‚¡æƒç»“æ„åˆ†é…'],
                ['è‚¡æƒç±»å‹', 'å æ€»è‚¡æƒæ¯”ä¾‹', 'è¯´æ˜'],
                ['èµ„é‡‘è‚¡', fundRatio + '%', 'æŒ‰å‡ºèµ„æ¯”ä¾‹åˆ†é…çš„è‚¡æƒ'],
                ['äººåŠ›è‚¡', laborRatio + '%', 'æŒ‰å·¥ä½œæŠ•å…¥åˆ†é…çš„è‚¡æƒ'],
                [''],
                ['èµ„é‡‘è‚¡åˆ†é… (å æ€»è‚¡æƒ' + fundRatio + '%)'],
                ['åˆä¼™äºº', 'å‡ºèµ„é‡‘é¢(å…ƒ)', 'èµ„é‡‘è‚¡å æ¯”', 'å¯¹åº”æ€»è‚¡æƒæ¯”ä¾‹'],
                ['åˆä¼™äºº A', invA, fundShareA.toFixed(1) + '%', fundEquityA.toFixed(1) + '%'],
                ['åˆä¼™äºº B (è‡ªåŠ¨è®¡ç®—)', invB, fundShareB.toFixed(1) + '%', fundEquityB.toFixed(1) + '%'],
                [''],
                ['äººåŠ›è‚¡åˆ†é… (å æ€»è‚¡æƒ' + laborRatio + '%)'],
                ['åˆä¼™äºº', 'äººåŠ›è‚¡å æ¯”', 'å¯¹åº”æ€»è‚¡æƒæ¯”ä¾‹', 'ä¸»è¦èŒè´£'],
                ['åˆä¼™äºº A', laborA + '%', laborEquityA.toFixed(1) + '%', roleA],
                ['åˆä¼™äºº B (è‡ªåŠ¨è®¡ç®—)', laborB + '%', laborEquityB.toFixed(1) + '%', roleB],
                [''],
                ['æœ€ç»ˆè‚¡æƒåˆ†é…ç»“æœ'],
                ['åˆä¼™äºº', 'èµ„é‡‘è‚¡æƒ', 'äººåŠ›è‚¡æƒ', 'æ€»è‚¡æƒæ¯”ä¾‹', 'è‚¡æƒä»·å€¼(å…ƒ)'],
                ['åˆä¼™äºº A', fundEquityA.toFixed(1) + '%', laborEquityA.toFixed(1) + '%', totalEquityA.toFixed(1) + '%', valueA],
                ['åˆä¼™äºº B', fundEquityB.toFixed(1) + '%', laborEquityB.toFixed(1) + '%', totalEquityB.toFixed(1) + '%', valueB]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "è‚¡æƒåˆ†é…");
            
            // è®¾ç½®åˆ—å®½
            ws['!cols'] = [
                {wch: 15},
                {wch: 15},
                {wch: 15},
                {wch: 15},
                {wch: 20}
            ];
            
            XLSX.writeFile(wb, 'åˆä¼™äººè‚¡æƒåˆ†é…è®¡ç®—è¡¨.xlsx');
        }
        
        // é¡µé¢åŠ è½½æ—¶è®¡ç®—ä¸€æ¬¡
        window.onload = function() {
            calculate();
        };
    </script>
</body>
</html>
